{"version":3,"sources":["index.tsx"],"names":["json","require","ret","getFirstPinyin","pinyin","normalize","replace","getLastPinyin","fix","data","word","endsWith","indexed","result","firstPinyin","lastPinyin","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","done","value","length","key1","values1","push","key2","values2","err","return","pinyins","Set","_loop","level","newpinyins","forEach","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","add","console","log","concat","size","handle","input","state","_loop2","v","filtered","filter","d","Math","floor","random","_ret","handle2","match","_loop3","_ret2","ReactDOM","render","react__WEBPACK_IMPORTED_MODULE_1___default","a","createElement","_React$useState","React","useState","_React$useState2","Object","_Users_zh_git_YiGeDingLia_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__","setState","_React$useState3","_React$useState4","seq","setSeq","keys","className","id","type","onChange","e","target","map","key","onClick","r","document","getElementById","innerText","copy","href","error","style","color","getElementsByTagName"],"mappings":"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","file":"static/js/main.3d55d7fc.chunk.js","sourcesContent":["import React from 'react';\nimport ReactDOM from 'react-dom';\nimport copy from 'copy-to-clipboard';\n\nimport './github-markdown.css';\n\nconst json = require('./idiom')\nlet ret = \"\"\n\ninterface Data {\n  abbreviation: string\n  derivation: string\n  example: string\n  explanation: string\n  pinyin: string\n  word: string\n  level?: number\n}\n\ninterface State {\n  firstPinyin: {\n    [key: string]: Data[]\n  }\n  lastPinyin: {\n    [key: string]: Data[]\n  }\n  word: {\n    [key: string]: Data\n  }\n  error?: string\n}\n\nconst getFirstPinyin = (pinyin: string) => {\n    return pinyin.normalize('NFKD').replace(/[^\\w\\s]|\\s.+/g, '')\n}\n\nconst getLastPinyin = (pinyin: string) => {\n    return pinyin.normalize('NFKD').replace(/[^\\w\\s]|.+\\s/g, '')\n}\n\nconst fix = (data: Data) => {\n    if ('味同嚼蜡' === data.word) {\n        data.pinyin = data.pinyin.replace('cù', 'là')\n    }\n    if (data.word.endsWith('俩')) {\n        data.pinyin = data.pinyin.replace('liǎng', 'liǎ')\n    }\n    data.pinyin = data.pinyin.replace(/yi([ēéěèêe])/g, 'y$1')\n    return data;\n}\n\nconst indexed = (json: Data[]) => {\n    const result: State = {firstPinyin: {}, lastPinyin: {}, word: {}}\n    for (const data of json) {\n        fix(data)\n        if (data.word.length === 4) {\n            const key1 = getLastPinyin(data.pinyin)\n            const values1 = result.lastPinyin[key1] || []\n            result.lastPinyin[key1] = values1\n            values1.push(data)\n\n            const key2 = getFirstPinyin(data.pinyin)\n            const values2 = result.firstPinyin[key2] || []\n            result.firstPinyin[key2] = values2\n            values2.push(data)\n\n            result.word[data.word] = data\n        }\n    }\n    let pinyins = new Set(['yi'])\n    for (let level = 1; pinyins.size > 0; ++level) {\n        const newpinyins = new Set<string>()\n        pinyins.forEach(pinyin => {\n            for (const data of result.lastPinyin[pinyin] || []) {\n                if (!data.level) {\n                    data.level = level\n                    newpinyins.add(getFirstPinyin(data.pinyin))\n                }\n            }\n        })\n        console.log(`Generate ${newpinyins.size} entries for level ${level}`)\n        pinyins = newpinyins\n    }\n    return result\n}\n\nconst handle = (input: string, state: State) => {\n    const result: string[] = []\n    ret = \"\"\n    let data = state.word[input]\n    while (data && data.level) {\n        const level = data.level\n        ret += `${data.word}`\n        ret += \" \"\n        result.push(`${data.word}（${data.pinyin}）`)\n        if (level > 1) {\n            const next = state.firstPinyin[getLastPinyin(data.pinyin)]\n            const filtered = next.filter(d => d.level && d.level < level)\n            data = filtered[Math.floor(Math.random() * filtered.length)]\n        } else {\n            result.push('一个顶俩（yī gè dǐng liǎ）')\n            ret += \"一个顶俩\"\n            return result\n        }\n    }\n    return result\n}\n\nconst handle2 = (input: string, state: State) => {\n    const result: string[] = []\n    ret = \"\"\n    if (!input.match(/[\\p{ASCII}]+/u)) {\n        return result\n    }\n    const next = state.firstPinyin[input]\n    if (next === undefined) return result\n    const index = Math.floor(Math.random() * next.length)\n    let data = next[index];\n    while (data && data.level) {\n        const level = data.level\n        ret += `${data.word}`\n        ret += \" \"\n        result.push(`${data.word}（${data.pinyin}）`)\n        if (level > 1) {\n            const next = state.firstPinyin[getLastPinyin(data.pinyin)]\n            const filtered = next.filter(d => d.level && d.level < level)\n            data = filtered[Math.floor(Math.random() * filtered.length)]\n        } else {\n            result.push('一个顶俩（yī gè dǐng liǎ）')\n            ret += \"一个顶俩\"\n            return result\n        }\n    }\n    return result\n}\n\nfunction App() {\n    const [state, setState] = React.useState<State>({firstPinyin: {}, lastPinyin: {}, word: {}})\n    const [seq, setSeq] = React.useState<string[]>([])\n\n    const handleClick = (e: any) => {\n        let r = document.getElementById(\"ret\")\n        if (r == null) {\n\n        } else {\n            console.log(r.innerText)\n            copy(r.innerText)\n        }\n    }\n\n    if (Object.keys(state.word).length > 0) {\n        return <div className='markdown-body'>\n            <h1>一个顶俩</h1>\n            <p>请输入一个四字成语，如成功识别：</p>\n            <p>本页面将自动为你接龙到“一个顶俩”</p>\n            <p><input id=\"input1\" type='input' onChange={e => setSeq(handle(e.target.value, state))}/></p>\n            <p></p>\n            <p>下面这个输入你想要的拼音来生成一个顶俩</p>\n            <p><input id=\"input2\" type='input' onChange={e => setSeq(handle2(e.target.value, state))}/></p>\n            <ul>{seq.map(data => {\n                return <li key={data}>{data}</li>\n            })}</ul>\n            {/*<button onClick={fresh}>刷新</button>*/}\n            <button onClick={handleClick}>点击复制下面内容</button>\n            <p id=\"ret\">{ret}</p>\n            <p>网页来源：<a href='https://github.com/ustc-zzzz/yigedinglia'>https://github.com/ustc-zzzz/yigedinglia</a></p>\n            <p>数据来源：<a href='https://github.com/pwxcoo/chinese-xinhua'>https://github.com/pwxcoo/chinese-xinhua</a></p>\n        </div>\n    } else if (state.error) {\n        return <div className='markdown-body'>\n            <h1>一个顶俩</h1>\n            <p style={{color: 'red'}}>{`数据加载中...加载异常，请刷新重试：${state.error}`}</p>\n            <p>网页来源：<a href='https://github.com/ustc-zzzz/yigedinglia'>https://github.com/ustc-zzzz/yigedinglia</a></p>\n            <p>数据来源：<a href='https://github.com/pwxcoo/chinese-xinhua'>https://github.com/pwxcoo/chinese-xinhua</a></p>\n        </div>\n    } else {\n        // const base = 'https://raw.githubusercontent.com'\n        // const url = `${base}/pwxcoo/chinese-xinhua/master/data/idiom.json`\n        setState(indexed(json))\n        return <div className='markdown-body'>\n            <h1>一个顶俩</h1>\n            <p>数据加载中...</p>\n            <p>网页来源：<a href='https://github.com/ustc-zzzz/yigedinglia'>https://github.com/ustc-zzzz/yigedinglia</a></p>\n            <p>数据来源：<a href='https://github.com/pwxcoo/chinese-xinhua'>https://github.com/pwxcoo/chinese-xinhua</a></p>\n        </div>\n    }\n}\n\nReactDOM.render(<App/>, document.getElementsByTagName('main')[0])\n"],"sourceRoot":""}